---
title: "タスク シーケンス組み込み変数 | Configuration Manager"
description: "タスク シーケンス組み込み変数は、タスク シーケンスが実行されている環境に関する情報を提供し、その値は、タスク シーケンス全体で使用できます。"
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology:
- configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 02bc6bd4-ca53-4e22-8b80-d8ee5fe72567
caps.latest.revision: 15
caps.handback.revision: 0
author: Dougeby
ms.author: dougeby
manager: angrobe
translationtype: Human Translation
ms.sourcegitcommit: 1134bb2f04152288e72d40b1b1083f415cb4e900
ms.openlocfilehash: 4b1014bc9a5c17dd571e69e7f5bfdae060a3eb55


---
# <a name="task-sequence-built-in-variables-in-system-center-configuration-manager"></a>System Center Configuration Manager のタスク シーケンス組み込み変数

*適用対象: System Center Configuration Manager (Current Branch)*


 タスク シーケンス組み込み変数は、System Center Configuration Manager によって提供されます。 組み込み変数は、タスク シーケンスが実行されている環境に関する情報を提供し、その値は、タスク シーケンス全体を通じて使用できます。 通常、組み込み変数はタスク シーケンス内で最初のステップが実行される前に初期化されます。 たとえば、組み込み変数 **_SMSTSLogPath** は、タスク シーケンスの実行中に Configuration Manager コンポーネントがログ ファイルの書き込みに使用するパスを指定します。この環境変数は、すべてのタスク シーケンス ステップからアクセスできます。 しかし、_SMSTSCurrentActionName など、一部の変数は各手順の前に評価されます。 この組み込み変数の値は通常読み取り専用です。 アンダースコアで始まる名前を持つ組み込み変数の値は読み取り専用です。  

## <a name="task-sequence-built-in-variable-list"></a>タスク シーケンス組み込み変数の一覧  
 次の一覧では Configuration Manager で利用できる組み込み変数について説明します。  

|組み込み変数名|説明|  
|-----------------------------|-----------------|  
|_OSDDetectedWinDir|Configuration Manager バージョン 1602 以降、Windows PE の起動時に、タスク シーケンスがコンピューターのハード ドライブの以前のオペレーティング システムのインストールをスキャンします。 Windows フォルダーの場所は、この変数に格納されます。 タスク シーケンスを構成して、環境からこの値を取得して使用し、新しいオペレーティング システムのインストールに使用する同じ Windows フォルダーの場所を指定できます。|  
|_OSDDetectedWinDrive|Configuration Manager バージョン 1602 以降、Windows PE の起動時に、タスク シーケンスがコンピューターのハード ドライブの以前のオペレーティング システムのインストールをスキャンします。  オペレーティング システムがインストールされるハード ドライブの場所は、この変数に格納されます。 タスク シーケンスを構成して、環境からこの値を取得して使用し、新しいオペレーティング システムに使用する同じハード ドライブの場所を指定できます。|  
|_SMSTSAdvertID|現在実行中のタスク シーケンスの一意の ID を格納します。 Configuration Manager のソフトウェア配布展開 ID と同じフォーマットを使用します。 タスク シーケンスがスタンドアロン メディアから実行されている場合は、この変数は未定義になります。<br /><br /> 例:<br /><br /> **ABC20001**|  
|_TSAppInstallStatus|タスク シーケンスによって、_TSAppInstallStatus 変数に [アプリケーションのインストール] タスク シーケンス ステップでのアプリケーションのインストール ステータスが設定されます。 タスク シーケンスによって、この変数に次のいずれかの値が設定されます。<br /><br /> 1.**未定義**:[アプリケーションのインストール] タスク シーケンス ステップがまだ実行されていない場合に設定されます。<br />2.**エラー**:[アプリケーションのインストール] タスク シーケンス ステップで、エラーのために少なくとも 1 つのアプリケーションが失敗した場合に設定されます。<br />3.**警告**:[アプリケーションのインストール] タスク シーケンス ステップでエラーが発生しなかったが、要件を満たしていなかったために 1 つまたは複数のアプリケーションまたは必要な依存関係がインストールされなかった場合に設定されます。<br />4.**成功**:[アプリケーションのインストール] タスク シーケンス ステップで、エラーまたは警告が検出されなかった場合に設定されます。|  
|_SMSTSBootImageID|現在実行中のタスク シーケンスにブート イメージ パッケージが関連付けられている場合に、Configuration Manager のブート イメージ パッケージ ID を格納します。 Configuration Manager ブート イメージ パッケージが関連付けられていない場合、この変数は設定されません。<br /><br /> 例:<br /><br /> **ABC00001**|  
|_SMSTSBootUEFI|タスク シーケンスが UEFI モードで起動するコンピューターを検出した場合に、SMSTSBootUEFI 変数を設定します。|  
|_SMSTSClientGUID|Configuration Manager クライアント GUID の値を格納します。 タスク シーケンスがスタンドアロン メディアから実行されている場合、この変数は設定されません。<br /><br /> 例:<br /><br /> **0a1a9a4b-fc56-44f6-b7cd-c3f8ee37c04c**|  
|_SMSTSCurrentActionName|現在実行中のタスク シーケンス ステップの名前です。 この変数は、タスク シーケンス マネージャーが個々のステップを実行する前に設定されます。<br /><br /> 例:<br /><br /> **コマンド ラインの実行**|  
|_SMSTSDownloadOnDemand|現在のタスク シーケンスがオン デマンド ダウンロード モードで実行されている場合は **TRUE** に設定されます。このモードでは、コンテンツが必要になった場合にのみ、タスク シーケンス マネージャーがコンテンツをローカルにダウンロードします。|  
|_SMSTSInWinPE|この変数は、タスクの現在のステップが Windows PE 環境で実行されている場合は **TRUE** に、それ以外の場合は **FALSE** に設定されます。 このタスク シーケンス変数をテストして、現在のオペレーティング システム環境を特定できます。|  
|_SMSTSLastActionRetCode|最後に実行されたアクションが返したリターン コードを格納します。 この変数は、次の手順が実行されるかどうかを決定するための条件として使用できます。<br /><br /> 例:<br /><br /> **0**|  
|_SMSTSLastActionSucceeded|この変数は、最後のアクションが成功した場合は **TRUE** に、失敗した場合は **FALSE** に設定されます。 ステップが無効化されていたために、または関連する条件が **FALSE**と評価されたために最後のアクションがスキップされた場合も、この変数はリセットされません。前のアクションの値が引き続き保持されます。|  
|_SMSTSLaunchMode|タスク シーケンスの起動方法です。 タスク シーケンスは次の値を取ることができます。<br /><br /> -   **SMS** - タスク シーケンスは Configuration Manager クライアントを使用して起動されます。<br />-   **UFD** - タスク シーケンスは USB メディアを使って起動されます。このメディアは Windows XP/2003 によって作成されました。<br />-   **UFD+FORMAT** - タスク シーケンスは USB メディアを使って起動されます。このメディアは Windows Vista またはそれ以降の Windows オペレーティング システムによって作成されました。<br />-   **CD** - タスク シーケンスは CD を使用して起動されます。<br />-   **DVD** - タスク シーケンスは DVD を使用して起動されます。<br />-   **PXE** - タスク シーケンスは PXE から起動されます。<br />-   **HD** – タスク シーケンスはハード ディスクを使用して起動されます (事前設定されたメディアのみ)。|  
|_SMSTSLogPath|ログ ディレクトリへの完全なパスを格納します。 この値は、アクションが記録される場所を特定するために使用できます。 ハード ドライブが利用できない場合、この値は設定されません。|  
|_SMSTSMachineName|コンピューター名を格納します。 タスク シーケンスがすべてのステータス メッセージを記録するために使用するコンピューターの名前を格納します。 新しいオペレーティング システムで使用するコンピューター名を変更するには、 **OSDComputerName** 変数を使用します。<br /><br /> 例:<br /><br /> **ABC**|  
|_SMSTSMDataPath|SMSTSLocalDataDrive の値が定義するパスを指定します。 コレクション変数の設定などのように、タスク シーケンスが起動する前に SMSTSLocalDataDrive を定義すると、Configuration Manager はそのタスク シーケンスが起動された後で _SMSTSMDataPath 値を定義します。|  
|_SMSTSMediaType|インストールを開始するために使用するメディアの種類を指定します。 メディアの種類の例としては、ブート メディア、フル メディア、PXE、事前設定されたメディアなどがあります。|  
|_SMSTSMP|Configuration Manager の管理ポイントの IP アドレスを格納します。|  
|_SMSTSMPPort|Configuration Manager の管理ポイントの管理ポイント ポート番号を格納します。<br /><br /> 例:<br /><br /> **80**|  
|_SMSTSOrgName|タスク シーケンスの進行状況を示すユーザー インターフェイス ダイアログ ボックスに表示されるブランド タイトル名を格納します。<br /><br /> 例:<br /><br /> **XYZ 社**|  
|_SMSTSOSUpgradeActionReturnCode|セットアップから返される終了コード値 (成功または失敗を示す値) を格納します。  この変数は、オペレーティング システム アップグレードのタスク シーケンスのステップ中に設定されます。 これは、Windows 10 セットアップ コマンド ライン オプション /Compat で使用すると便利です。<br /><br /> 例:<br /><br /> /Compat が完了したら、終了コードが失敗か成功かに応じて、以降のステップでアクションを実行できます。 成功の場合は、アップグレードを開始できます。 または、環境にマーカーを設定して (たとえば、ファイルを追加したり、レジストリ キーを設定したりして)、アップグレードの準備ができているコンピューターや、アップグレード前にアクションが必要なコンピューターのコレクションを作成するときに使用できます。|  
|_SMSTSPackageID|現在実行中のタスク シーケンス ID を格納します。 この ID では Configuration Manager のソフトウェア パッケージ ID と同じ形式が使用されます。<br /><br /> 例:<br /><br /> **HJT00001**|  
|_SMSTSPackageName|現在実行中のタスク シーケンスの作成時に Configuration Manager 管理者によって指定されたタスク シーケンス名を格納します。<br /><br /> 例:<br /><br /> **Windows 10 タスク シーケンスの展開**|  
|_SMSTSSetupRollback|オペレーティング システムのセットアップでロールバック操作が実行されたかどうかを指定します。 変数の値には **true** または **false**を使用できます。|  
|_SMSTSRunFromDP|現在のタスク シーケンスが配布ポイントからの実行モードで実行されている場合は **TRUE** に設定されます。このモードでは、タスク シーケンス マネージャーは、配布ポイントから必要なパッケージ共有を取得します。|  
|_SMSTSSiteCode|Configuration Manager サイトのサイト コードを格納します。<br /><br /> 例:<br /><br /> **ABC**|  
|_SMSTSType|現在実行中のタスク シーケンスの種類です。 次の値のいずれかを取ります。<br /><br /> **1** - 一般タスク シーケンスを示します。<br /><br /> **2** - オペレーティング システムの展開タスク シーケンスを示します。|  
|_SMSTSTimezone|タイム ゾーン情報を次の形式で (スペースなしで) 格納します。<br /><br /> Bias, StandardBias, DaylightBias, StandardDate.wYear, wMonth, wDayOfWeek, wDay, wHour, wMinute, wSecond, wMilliseconds, DaylightDate.wYear, wMonth, wDayOfWeek, wDay, wHour, wMinute, wSecond, wMilliseconds, StandardName, DaylightName<br /><br /> 例:<br /><br /> 米国およびカナダ東部標準時の場合、この値は **300,0,-60,0,11,0,1,2,0,0,0,0,3,0,2,2,0,0,0,Eastern Standard Time,Eastern Daylight Time**となります。|  
|_SMSTSUseCRL|管理ポイントとの通信に SSL (Secure Sockets Layer) 証明書を使用する場合に、タスク シーケンスが証明書失効リストを使用するかどうかを指定します。|  
|_SMSTSUserStarted|タスク シーケンスがユーザーによって開始されたかどうかを示します。 この変数は、タスク シーケンスがソフトウェア センターから開始された場合のみ設定されます。 たとえば、 **_SMSTSLaunchMode** が **SMS**に設定されている場合などです。 この変数は次の値のいずれかを取ります。<br /><br /> -   **TRUE** - タスク シーケンスがユーザーによってソフトウェア センターから手動で開始されたことを示します。<br />-   **false** - タスク シーケンスが Configuration Manager スケジューラによって自動的に開始されたことを示します。|  
|_SMSTSUseSSL|タスク シーケンスが Configuration Manager 管理ポイントとの通信に SSL を使用するかどうかを表します。 サイトがネイティブ モードで実行されている場合、値は **TRUE**に設定されます。|  
|_SMSTSWTG|コンピューターが Windows To Go デバイスとして動作しているかどうかを指定します。|  
|OSDPreserveDriveLetter|Configuration Manager バージョン 1606 以降、このタスク シーケンス変数は使用されていません。 既定では、オペレーティング システムの展開中に、Windows セットアップが、使用する最適なドライブ文字を決定します (通常は C:)。 <br /><br />以前のバージョンでは、OSDPreverveDriveLetter 変数は、タスク シーケンスが、対象コンピューターにそのイメージを適用するときに、オペレーティング システム イメージ WIM ファイルにキャプチャされたドライブ文字を使用するかどうかを判断します。 この変数の値を **False** に設定して、 **[オペレーティング システムの適用]** タスク シーケンス ステップの **[適用先]** 設定で指定した場所を使用できます。 詳細については、「 [Apply Operating System Image](task-sequence-steps.md#BKMK_ApplyOperatingSystemImage)」を参照してください。|  
|SMSTSAssignmentsDownloadInterval|この変数は、ポリシーが返されなかった前回の試行から、ポリシーのダウンロードをクライアントが試行するまで待機する秒数を指定するために使用します。 既定では、クライアントは **0** 秒待機してから再試行します。<br /><br /> この変数は、メディアまたは PXE から起動前コマンドを使用して設定できます。|  
|SMSTSAssignmentsDownloadRetry|この変数は、初回の試行でポリシーが見つからなかった場合に、ポリシーのダウンロードをクライアントが試行する回数を指定するために使用します。 既定では、クライアントは **0** 回再試行します。<br /><br /> この変数は、メディアまたは PXE から起動前コマンドを使用して設定できます。|  
|SMSTSAssignUsersMode|タスク シーケンスがユーザーを対象コンピューターと関連付ける方法を示します。 値を次のいずれかに設定します。<br /><br /> -   自動: タスク シーケンスは、オペレーティング システムを展開先コンピューターに展開するとき、指定されたユーザーと展開先コンピューターの間の関係を作成します。<br />-   保留: タスク シーケンスは、指定されたユーザーと展開先コンピューターの関係を作成しますが、この関係が設定される前に、管理者からの許可を待ちます。<br />-   無効: タスク シーケンスは、オペレーティング システムの展開時に、ユーザーを展開先コンピューターに関連付けません。|  
|SMSTSDownloadProgram|この変数を使用して代替のコンテンツ プロバイダーを指定します。このプロバイダーは、タスク シーケンスで既定の Configuration Manager ダウンローダーの代わりにコンテンツをダウンロードするために使用されます。 コンテンツのダウンロード プロセスの一部として、タスク シーケンスは、指定されているダウンローダー プログラムの変数を確認します。 指定されている場合、タスク シーケンスはそのプログラムでダウンロードを実行します。|  
|SMSTSDownloadRetryCount|配布ポイントからコンテンツをダウンロードするように Configuration Manager が試行する回数を指定するために使用します。 既定では、クライアントは **2** 回再試行します。|  
|SMSTSDownloadRetryDelay|配布ポイントからコンテンツをダウンロードするように再試行する前に Configuration Manager が待機する秒数を指定するために使用します。 既定では、クライアントは **15** 秒待機してから再試行します。|  
|SMSTSErrorDialogTimeout|タスク シーケンスでエラーが発生すると、ダイアログが表示されます。このダイアログは、既定のタイムアウト値が経過すると自動的に閉じられます。 既定では、 **900** 秒 (15 分) 後にダイアログ ボックスが自動的に閉じます。|  
|TSErrorOnWarning|タスク シーケンス エンジンがタスク シーケンスのステップのアプリケーションのインストール中に、検出された警告をエラーとしてと見なされるかどうかを指定するには、この変数を使用します。 1 つまたは複数のアプリケーション、または、必要な依存関係がインストールされていない場合、要件を満たしていないため、タスク シーケンスは _TSAppInstallStatus 変数を **警告** に設定します。 TSErrorOnWarning 変数を **True** に設定し、_TSAppInstallStatus 変数を [警告] に設定すると、エラーとして扱われます。 値 **False** が既定の動作です。|  
|SMSTSLanguageFolder|言語に依存しないブート イメージの表示言語を変更するときに使用します。|  
|SMSTSLocalDataDrive|タスク シーケンスの実行中に一時ファイルを対象コンピューターに格納する場所を指定します。<br /><br /> この変数は、コレクション変数の設定によって行うなど、タスク シーケンスが開始する前に設定される必要があります。 タスク シーケンスが開始された後で、Configuration Manager は _SMSTSMDataPath 変数を定義します。|  
|SMSTSMPListRequestTimeout|タスク シーケンスでロケーション サービスから管理ポイント一覧を取得できなかった場合に、アプリケーションまたはソフトウェア更新プログラムのインストールを再試行するまでの待ち時間をミリ秒単位で指定します。 既定では、タスク シーケンスは 60,000 ミリ秒 (60 秒) 待機してからステップを再試行します。再試行は 3 回までです。 この変数の値は、[アプリケーションのインストール] および [ソフトウェア更新プログラムのインストール] タスク シーケンス ステップにのみ適用されます。|  
|SMSTSMPListRequestTimeoutEnabled|クライアントがイントラネット上にない場合に、繰り返しの MPList 要求を有効にしてクライアントを更新するには、この変数を使用します。 <br />既定では、この変数は True に設定されます。 クライアントがインターネット上にある場合は、不必要な遅延を回避するためにこの変数を False に設定することができます。 この変数の値は、[アプリケーションのインストール] および [ソフトウェア更新プログラムのインストール] タスク シーケンス ステップにのみ適用されます。|  
|SMSTSPeerDownload|この変数を使用して、クライアントに Windows PE ピア キャッシュの使用を許可します。<br /><br /> 例:<br /><br /> この機能は、SMSTSPeerDownload  = **TRUE** により有効になります。|  
|SMSTSPeerRequestPort|この Windows PE ピア キャッシュの変数を使用して、[クライアント設定] で構成された既定のポート (8003 と 8004) を使用しない場合の、初期ブロードキャストに使用するカスタム ネットワーク ポートを指定します。|  
|SMSTSPersistContent|コンテンツをタスク シーケンス キャッシュに一時的に保存するときに使用します。|  
|SMSTSPostAction|タスク シーケンスの完了後に実行されるコマンドを指定します。 たとえば、指定のデバイスにタスク シーケンスがオペレーティング システムを展開した後、埋め込みデバイスでフィルターを有効にするスクリプトを記述するのにこの変数を使用できます。|  
|SMSTSPreferredAdvertID|対象のコンピューターで特定の展開が実行されるように強制します。 これはメディアまたは PXE から起動前コマンドを使って設定できます。 この変数が設定されると、タスク シーケンスは要求されたすべての展開を上書きします。|  
|SMSTSPreserveContent|この変数は、展開後に Configuration Manager クライアント キャッシュに残すタスク シーケンス内のコンテンツにフラグを設定します。 これは、タスク シーケンスの持続期間だけコンテンツを保持して、Configuration Manager クライアント キャッシュではなくタスク シーケンス キャッシュを使用する SMSTSPersistContent の使用とは異なります。<br /><br /> 例:<br /><br /> この機能は、SMSTSPreserveContent = **TRUE** により有効になります。|  
|SMSTSRebootDelay|コンピューターが再起動するまでの待機時間を秒単位で指定します。 この変数を 0 以外に設定すると、タスク シーケンス マネージャーは再起動の前に通知ダイアログ ボックスを表示します。<br /><br /> 例:<br /><br /> **0**<br /><br /> **30**|  
|SMSTSRebootMessage|再起動が要求されたときにスケジュール ダイアログ ボックスに表示するメッセージを指定します。 この変数を設定しなかった場合、既定のメッセージが表示されます。<br /><br /> 例:<br /><br /> このコンピューターはタスク シーケンス マネージャーによって再起動されます。****|  
|SMSTSRebootRequested|現在のタスク シーケンスのステップを完了した後で再起動が必要であることを示します。 再起動が必要な場合は、この変数を **TRUE**に設定すると、このタスク シーケンス ステップの後で、タスク シーケンス マネージャーが自動的にコンピューターを再起動します。 タスク シーケンス ステップの完了に再起動が必要な場合は、タスク シーケンス ステップでこのタスク シーケンス変数を設定する必要があります。 コンピューターの再起動後、タスク シーケンスは次のタスク シーケンス ステップから続行されます。|  
|SMSTSRetryRequested|現在のタスク シーケンスのステップを完了した後で再試行を要求します。 このタスク シーケンス変数を設定した場合、 **SMSTSRebootRequested** も **TRUE**に設定する必要があります。 コンピューターの再起動後、タスク シーケンス マネージャーは同じタスク シーケンスのステップを再実行します。|  
|SMSTSSoftwareUpdateScanTimeout| [ソフトウェア更新プログラムのインストール](task-sequence-steps.md#BKMK_InstallSoftwareUpdates) タスク シーケンスのステップ中に、ソフトウェア更新プログラムのスキャンのタイムアウトを制御することができます。 たとえば、多数のソフトウェア更新プログラムをインストールする必要がある場合は、既定値を上げる場合があります。 既定値は 30 分です。 |
|SMSTSUDAUsers|対象のコンピューターのプライマリ ユーザーを指定します。 次の形式を使ってユーザーを指定します。 複数のユーザーは、コンマ (,) で区切ります。<br /><br /> 例:<br /><br /> **domain\user1, domain\user2, domain\user3**<br /><br /> ユーザーを対象コンピューターに関連付ける方法の詳細については、「[Associate users with a destination computer](../get-started/associate-users-with-a-destination-computer.md)」 (ユーザーをセットアップ先のコンピューターに関連付ける) を参照してください。|  
|SMSTSWaitForSecondReboot|Configuration Manager バージョン 1602 以降、ソフトウェア更新プログラムのインストールで 2 回再起動が必要な場合に、クライアントの動作を制御するのに役立つ、この省略可能なタスク シーケンス変数を使用できます。 この変数は、ソフトウェア更新プログラムのインストールからの 2 つ目の再起動によってタスク シーケンスが失敗するのを防ぐために、[ソフトウェア更新プログラムのインストール](task-sequence-steps.md#BKMK_InstallSoftwareUpdates) ステップの前に設定する必要があります。<br /><br /> SMSTSWaitForSecondReboot 値を秒単位で設定し、コンピューターを再起動する場合のソフトウェア更新プログラムのインストール ステップ中のタスク シーケンスの一時停止の長さを指定し、2 つ目の再起動がある場合に十分な時間を取るようにします。 <br />たとえば、SMSTSWaitForSecondReboot を 600 に設定した場合、再起動してから追加のタスク シーケンス ステップが実行されるまで、タスク シーケンスが 10 分間一時停止します。 これは、何百ものソフトウェア更新プログラムが 1 つのソフトウェア更新プログラムのインストール タスク シーケンス ステップでインストールされる場合に便利です。|  



<!--HONumber=Nov16_HO1-->


