---
title: "ブート イメージの管理 | Configuration Manager"
description: "Configuration Manager で、オペレーティング システムの展開中に使用する Windows PE ブート イメージを管理する方法について説明します。"
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology:
- configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 97f2d81a-2c58-442c-88bc-defd5a1cd48f
caps.latest.revision: 23
caps.handback.revision: 0
author: Dougeby
ms.author: dougeby
manager: angrobe
translationtype: Human Translation
ms.sourcegitcommit: 1134bb2f04152288e72d40b1b1083f415cb4e900
ms.openlocfilehash: 43b87f7fd9d710cb4e7784dc34b4a8b14585b247


---
# <a name="manage-boot-images-with-system-center-configuration-manager"></a>System Center Configuration Manager でのブート イメージの管理

*適用対象: System Center Configuration Manager (Current Branch)*

Configuration Manager のブート イメージは、オペレーティング システムの展開中に使用される [Windows PE (WinPE)](https://msdn.microsoft.com/library/windows/hardware/dn938389%28v=vs.85%29.aspx) のイメージです。 ブート イメージは、WinPE でコンピューターを起動するために使用されます。WinPE は、セットアップ先のコンピューターで Windows のインストールを準備する限られたコンポーネントとサービスが含まれた、最小限のオペレーティング システムです。  ブート イメージを管理するときは、以下のセクションを参照してください。

##  <a name="a-namebkmkbootimagedefaulta-default-boot-images"></a><a name="BKMK_BootImageDefault"></a> 既定のブート イメージ  
 Configuration Manager には 2 つの既定のブート イメージがあります。一方は x86 プラットフォームをサポートし、もう一方は x64 プラットフォームをサポートします。 これらのイメージは次の場所に格納されています: \\\\*servername*>\SMS_<*sitecode*>\osd\boot\\<*x64 または i386*。  

 Configuration Manager を新しいバージョンにアップグレードすると、Configuration Manager によってこの場所にある既定のブート イメージ、および既定のブート イメージに基づくカスタマイズされたブート イメージが更新されたファイルに置き換えられます。 サイトで既定のブート イメージに構成するオプション (省略可能なコンポーネントなど) は、ドライバーを含めて、ブート イメージが更新されたときに引き継がれます。 ソース ドライバー オブジェクトは、ドライバーのソース ファイルを含めて、有効である必要があり、そうでない場合、ドライバーは、サイトの更新されたブート イメージに追加されません。 同じ Windows ADK バージョンに基づく場合でも、既定のブート イメージに基づいていない他のブート イメージは更新されません。 ブート イメージが更新されたら、配布ポイントに再配布する必要があります。 ブート イメージを使用するメディアを再作成する必要があります。 カスタマイズした既定のブート イメージを自動的に更新しない場合、別の場所に保存する必要があります。  

 **[ソフトウェア ライブラリ]** に追加したすべてのブート イメージに対して Configuration Manager トレース ログ ツールが追加されます。 WinPE では、コマンド プロンプトから「**CMTrace**」と入力して、Configuration Manager トレース ログ ツールを起動できます。  

##  <a name="a-namebkmkbootimagecustoma-customize-a-boot-image"></a><a name="BKMK_BootImageCustom"></a> ブート イメージのカスタマイズ  
 サポートされているバージョンの Windows ADK の Windows PE バージョンに基づいているブート イメージであれば、Configuration Manager コンソールからカスタマイズしたり、[ブート イメージの変更](#BKMK_ModifyBootImages)を行ったりできます。 新しいバージョンでサイトがアップグレードされ、新しいバージョンの Windows ADK がインストールされている場合、カスタム ブート イメージ (既定のブート イメージの場所ではない) は新しいバージョンの Windows ADK で更新されません。 このことが発生する場合、Configuration Manager コンソールでブート イメージをカスタマイズできなくなります。 ただし、引き続き、アップグレード前に同様に動作します。  

 ブート イメージが、サイトにインストールされた Windows ADK とは別のバージョンに基づく場合、そのブート イメージは、別の方法でカスタマイズする必要があります。たとえば、Windows AIK と Windows ADK に含まれている、展開イメージのサービスと管理 (DISM) コマンドライン ツールなどを使います。 詳細については、「[ブート イメージのカスタマイズ](customize-boot-images.md)」を参照してください。  

##  <a name="a-namebkmkaddbootimagesa-add-a-boot-image"></a><a name="BKMK_AddBootImages"></a> ブート イメージの追加  

 サイトのインストール中に、Configuration Manager は、Windows ADK のサポートされているバージョンから、WinPE バージョンに基づくブート イメージを自動的に追加します。 Configuration Manager のバージョンによっては、サポートされているバージョンの Windows ADK とは異なるバージョンの WinPE に基づくブート イメージを追加できる場合があります。  サポートされていないバージョンの WinPE が含まれるブート イメージを追加しようとすると、エラーが発生します。  

 サポートされている Windows ADK のバージョン、Configuration Manager コンソールからカスタマイズできるブート イメージのベースとなる Windows PE バージョン、DISM でカスタマイズした後で Configuration Manager に追加できるブート イメージのベースとなる Windows PE バージョンは次のとおりです。  

-   **Windows ADK バージョン**  

     Windows 10 用 Windows ADK  

-   **Configuration Manager コンソールでカスタマイズできる Windows PE ブート イメージのバージョン**  

     Windows PE 10  

-   **Configuration Manager コンソールでカスタマイズできない Windows PE ブート イメージのバージョン**  

     Windows PE 3.1<sup>1</sup> および Windows PE 5  

     <sup>1</sup> Windows PE 3.1 のブートイメージしか Configuration Manager に追加することができません。 Windows AIK for Windows 7 (Windows PE 3 の構築用) を Windows AIK Supplement for Windows 7 SP1 (Windows PE 3.1 の構築用) にアップグレードしてください。 Windows AIK Supplement for Windows 7 SP1 は、 [Microsoft ダウンロード センター](http://www.microsoft.com/download/details.aspx?id=5188)からダウンロードできます。  

     たとえば、Configuration Manager を使っている場合は、Windows 10 用 Windows ADK (Windows PE 10 に基づく) で構築したブート イメージを Configuration Manager コンソールでカスタマイズできます。 一方、Windows PE 5 のブート イメージはサポートされていますが、このブート イメージをカスタマイズするには、別のコンピューターにある Windows 8 用 Windows ADK に付属している DISM を使わなければなりません。 その後、ブート イメージを Configuration Manager コンソールに追加できます。 ブート イメージのカスタマイズ (オプションのコンポーネントとドライバーの追加)、ブート イメージのコマンド サポートの有効化、Configuration Manager コンソールへのブート イメージの追加、ブート イメージによる配布ポイントの更新の手順の詳細については、「[ブート イメージのカスタマイズ](customize-boot-images.md)」を参照してください。

 ブート イメージを手動で追加するには、次の手順に従います。  

#### <a name="to-add-a-boot-image"></a>ブート イメージを追加するには  

1.  Configuration Manager コンソールで、[ソフトウェア ライブラリ] ****をクリックします。  

2.  [ **ソフトウェア ライブラリ** ] ワークスペースで [ **オペレーティング システム**] を展開し、[ **ブート イメージ**] をクリックします。  

3.  [ **ホーム** ] タブの [ **作成** ] グループで、[ **ブート イメージの追加** ] をクリックし、ブート イメージの追加ウィザードを開始します。  

4.  [ **データ ソース** ] ページで以下のオプションを指定し、[ **次へ**] をクリックします。  

    -   [パス **** ] ボックスで、ブート イメージの WIM ファイルへのパスを指定します。  

         このパスは、UNC 形式の有効なネットワーク パスでなければなりません。 例: \\\\<*servername*\\<*sharename*>\\<*bootimagename*>.wim  

    -   [ **ブート イメージ** ] ドロップダウン リストで、インポートするブート イメージを選択します。 WIM ファイルに複数のブート イメージが含まれている場合、該当するイメージを選びます。  

5.  [ **全般**  ] ページで、以下のオプションを指定して [ **次へ**] をクリックします。  

    -   [ **名前** ] ボックスで、ブート イメージの一意の名前を指定します。  

    -   [ **バージョン** ] ボックスで、ブート イメージのバージョン番号を指定します。  

    -   [ **コメント** ] ボックスで、ブート イメージの使用方法について簡単な説明を指定します。  

6.  ウィザードを完了します。  

 Configuration Manager コンソールの** [ ブート イメージ]** ノードに、ブート イメージが一覧表示されます。 ただし、ブート イメージを使用してオペレーティング システムを展開する前に、配布ポイント、配布ポイント グループ、または配布ポイント グループに関連付けられているコレクションにブート イメージを配布する必要があります。  

> [!NOTE]  
>  Configuration Manager コンソールで **[ブート イメージ]** ノードを選ぶと、**[サイズ (KB)]** 列に、各ブート イメージの圧縮解除後のサイズが表示されます。 ただし、Configuration Manager がネットワーク経由でブート イメージを送信する際は、イメージの圧縮コピーを送信します。このコピーは通常、**[サイズ (KB)]** 列に示されているサイズよりもはるかに小さいサイズです。  

##  <a name="a-namebkmkdistributebootimagesa-distribute-boot-images-to-a-distribution-point"></a><a name="BKMK_DistributeBootImages"></a> 配布ポイントへのブート イメージの配布  
 ブート イメージは、他のコンテンツを配布するのと同じ方法で配布ポイントに配布されます。 ほとんどの場合は、オペレーティング システムを展開する前、およびメディアを作成する前に、少なくとも 1 つの配布ポイントにブート イメージを配布する必要があります。  

> [!NOTE]  
>  PXE を使用してオペレーティング システムを展開するには、ブート イメージを配布する前に次の点を考慮します。  
>   
>  -   配布ポイントは、PXE 要求を受け入れるように構成する必要があります。  
> -   x86 と x64 の両方の PXE 対応ブート イメージを、少なくとも 1 つの PXE 対応配布ポイントに配布する必要があります。  
> -   Configuration Manager は、ブート イメージを、PXE 対応配布ポイント上の **RemoteInstall** フォルダーに配布します。  
>   
>  PXE を使用してオペレーティング システムを展開する方法の詳細については、「[PXE を使用したネットワーク経由での Windows の展開](../deploy-use/use-pxe-to-deploy-windows-over-the-network.md)」を参照してください。  

 ブート イメージを配布する手順については、「 [Distribute content](../../core/servers/deploy/configure/deploy-and-manage-content.md#a-namebkmkdistributea-distribute-content)」をご覧ください。  

##  <a name="a-namebkmkmodifybootimagesa-modify-a-boot-image"></a><a name="BKMK_ModifyBootImages"></a> ブート イメージの変更  
 デバイス ドライバーをイメージに追加または削除したり、ブート イメージに関連付けられているプロパティを編集したりできます。 追加または削除するデバイス ドライバーには、ネットワーク アダプターまたは大容量記憶装置のデバイス ドライバーが含まれる可能性があります。 ブート イメージを変更する際には、以下の点をご考慮ください。  

-   デバイス ドライバーをブート イメージに追加するには、事前にデバイス ドライバー カタログのデバイス ドライバーをインポートして有効にする必要があります。  

-   ブート イメージを変更しても、ブート イメージが参照する関連パッケージは一切変更されません。  

-   ブート イメージを変更したら、既にそのブート イメージを含む配布ポイント上のブート イメージを **更新** し、最新バージョンのブート イメージを利用できるようにする必要があります。 詳細については、「 [Manage content you have distributed](../../core/servers/deploy/configure/deploy-and-manage-content.md#a-namebkmkmanagea-manage-the-content-you-have-distributed)」を参照してください。  

 ブート イメージを変更するには、次の手順に従います。  

#### <a name="to-modify-the-properties-of-a-boot-image"></a>ブート イメージのプロパティを変更するには  

1.  Configuration Manager コンソールで、[ソフトウェア ライブラリ] ****をクリックします。  

2.  [ **ソフトウェア ライブラリ** ] ワークスペースで [ **オペレーティング システム**] を展開し、[ **ブート イメージ**] をクリックします。  

3.  変更するブート イメージを選択します。  

4.  [ホーム **** ] タブの [プロパティ **** ] グループで [プロパティ **** ] をクリックして、ブート イメージの [プロパティ **** ] ダイアログ ボックスを開きます。  

5.  ブート イメージの動作を変更するには、以下の設定を行います。  

    -   外部ツールを使用してブート イメージのプロパティを変更した場合は、[イメージ **** ] タブで [再読み込み ****] をクリックします。  

    -   **[ドライバー]** タブで、WinPE をブートするために必要な Windows デバイス ドライバーを追加します。 デバイス ドライバーを追加する際には、以下の点を考慮してください。  

        -   **[ブート イメージのアーキテクチャに一致しないドライバーを非表示にする]** を選び、ブート イメージのアーキテクチャのドライバーのみを表示します。 アーキテクチャは、製造元が提供する .INF で報告されるアーキテクチャに基づいています。  

        -   **[記憶域クラスおよびネットワーク クラス以外のドライバーを非表示にする (ブート イメージの場合)]** を選び、ストレージとネットワーク ドライバーのみを表示し、ビデオ ドライバーまたはモデム ドライバーなど、通常ブート イメージに必要でない他のドライバーを非表示にします。  

        -   **[デジタル署名されていないドライバーを非表示にする]** を選び、デジタル署名されていないドライバーを非表示にします。  

        -   他のドライバーを WinPE に含める要件がない場合は、最適な方法として、NIC ドライバーと大容量記憶装置ドライバーのみブート イメージに追加します。  

        -   WinPE には多くの組み込みドライバーが既に付属しているため、WinPE で提供されない NIC ドライバーと大容量記憶装置ドライバーのみ追加します。  

        -   ブート イメージに追加するドライバーがブート イメージのアーキテクチャと一致していることを確認します。  

        > [!NOTE]  
        >  ブート イメージに追加する前に、デバイス ドライバーをドライバー カタログにインポートする必要があります。 デバイス ドライバーをインポートする方法については、「[ドライバーの管理](manage-drivers.md)」を参照してください。  

    -   [カスタマイズ **** ] タブで、以下の設定を選択します。  

        -   [起動前コマンドを有効にする **** ] チェック ボックスをオンにして、タスク シーケンスを実行する前に実行するコマンドを指定します。 起動前コマンドを有効にすると、実行するコマンド ライン、コマンドの実行にサポート ファイルが必要かどうか、およびそれらのサポート ファイルのソースの場所を指定できます。  

            > [!WARNING]  
            >  **cmd /c** をコマンドラインの先頭に追加する必要があります。 **cmd /c** を指定しない場合、実行後にコマンドが閉じられません。 展開がコマンドの完了を待機し続けて、その他の構成済みのコマンドや操作が開始されません。  

            > [!TIP]  
            >  タスク シーケンス メディアの作成中に、パッケージ ID と起動前コマンドライン (タスク シーケンスの変数の値を含む) が、Configuration Manager コンソールを実行しているコンピューターの CreateTSMedia.log というログファイルに書き込まれます。 このログ ファイルで、タスク シーケンスの変数の値を確認できます。  

        -   **[Windows PE の背景]** 設定を構成して、既定の WinPE の背景またはカスタムの背景のいずれを使用するのかを指定します。  

        -   ブート イメージの展開時に **F8** キーを使用してコマンド プロンプトを開くには、 **[コマンド サポートを有効にする (テストのみ)]** を選びます。 これは、展開をテストする際のトラブルシューティングに役立ちます。 実稼働環境の展開でこの設定を使用することは推奨されません。  

        -   Windows PE のスクラッチ領域を構成します。これは、WinPE で使用される一時記憶域 (RAM ドライブ) です。 たとえば、WinPE 内で実行するアプリケーションが一時ファイルに書き込む必要がある場合、WinPE はメモリ内のスクラッチ領域にファイルをリダイレクトすることで、ハード ディスクが存在することをシミュレートします。 既定で、WinPE は 32 メガバイト (MB) の書き込み可能メモリを割り当てています。  

    -   [データ ソース **** ] タブで、以下の設定を更新します。  

        -   ブート イメージのソース ファイルを変更するには、 **[イメージ パス]** と **[イメージ インデックス]** を設定します。  

        -   ブート イメージを更新するスケジュールを作成するには、 **[スケジュールに従って配布ポイントを更新する]** を選びます。  

        -   別のコンテンツ用の容量を確保するために、このパッケージのコンテンツのクライアント キャッシュを期限切れにする必要がない場合、 **[クライアント キャッシュの内容を保持する]** を選びます。  

        -   配布ポイントでブート イメージ パッケージが更新された場合に、変更のあったファイルのみ配布するように指定するには、 **[バイナリ差分レプリケーションを有効にする]** を選びます。 この設定により、特にブート イメージ パッケージが大きく変更が比較的少ない場合に、サイト間のネットワーク トラフィックを最小限に抑えることができます。  

        -   ブート イメージを PXE 対応の展開で使用する場合、**[このブート イメージを PXE 対応の配布ポイントから展開する]** を選びます。  

            > [!NOTE]  
            >  詳細については、「[PXE を使用したネットワーク経由での Windows の展開](../deploy-use/use-pxe-to-deploy-windows-over-the-network.md)」を参照してください。  

    -   [データ アクセス **** ] タブで、以下の設定を選択します。  

        -   クライアントでこのパッケージのコンテンツをネットワークからインストールする場合は、[パッケージ共有の設定 **** ] を設定します。  

        -   **[パッケージの更新設定]** を設定して、Configuration Manager で配布ポイントからユーザーを切断する方法を指定します。 ユーザーが配布ポイントに接続されていると、Configuration Manager がブート イメージを更新できない場合があります。  

    -   [配布の設定 **** ] タブで、以下の設定を選択します。  

        -   **[配布の優先順位]** リストに、複数のパッケージを同じ配布ポイントに配布する場合に Configuration Manager が使用する優先レベルを指定します。  

        -   優先配布ポイントへのオンデマンドのコンテンツ配布を有効にする場合、 **[このパッケージのコンテンツを優先配布ポイントに配布する]** を選びます。 この設定を有効にすると、クライアントがパッケージのコンテンツを要求し、そのコンテンツが優先配布ポイントにないときは、管理ポイントはすべての優先配布ポイントにコンテンツを配布します。  

        -   [事前設定された配布ポイントの設定 **** ] を設定して、事前設定済みコンテンツが有効になっている配布ポイントにブート イメージを配布する方法を指定します。  

            > [!NOTE]  
            >  事前設定済みコンテンツについて詳しくは、「 [Prestage content](../../core/servers/deploy/configure/deploy-and-manage-content.md#a-namebkmkprestagea-use-prestaged-content)」をご覧ください。  

    -   [コンテンツの場所 **** ] タブで、配布ポイントまたは配布ポイント グループを選択して、次の操作を実行します。  

        -   選択した配布ポイントまたは配布ポイント グループに再度ブート イメージを配布するには、[再配布 **** ] をクリックします。  

        -   選択した配布ポイントまたは配布ポイント グループのブート イメージ パッケージの整合性を確認するには、[検証 **** ] をクリックします。  

    -   **[オプション コンポーネント]** タブで、Configuration Manager で使用するために Windows PE に追加するコンポーネントを指定します。 使用可能なオプション コンポーネントについて詳しくは、「 [WinPE: パッケージの追加 (オプション コンポーネント リファレンス)](https://msdn.microsoft.com/library/windows/hardware/dn938382\(v=vs.85\).aspx)」をご覧ください。  

    -   [セキュリティ **** ] タブで、管理ユーザーを選択して、その管理ユーザーが実行できる操作を変更します。  

6.  プロパティを構成したら、[OK ****] をクリックします。  

##  <a name="a-namebkmkbootimagepxea-configure-a-boot-image-to-deploy-from-a-pxe-enabled-distribution-point"></a><a name="BKMK_BootImagePXE"></a> PXE 対応の配布ポイントから展開するブート イメージの構成  
 PXE オペレーティング システムの展開用ブート イメージを使用するには、PXE 対応の配布ポイントから展開するブート イメージをあらかじめ構成する必要があります。  

#### <a name="to-configure-a-boot-image-to-deploy-from-a-pxe-enabled-distribution-point"></a>PXE 対応の配布ポイントから展開するブート イメージを構成するには  

1.  Configuration Manager コンソールで、[ソフトウェア ライブラリ] ****をクリックします。  

2.  [ **ソフトウェア ライブラリ** ] ワークスペースで [ **オペレーティング システム**] を展開し、[ **ブート イメージ**] をクリックします。  

3.  変更するブート イメージを選択します。  

4.  [ホーム **** ] タブの [プロパティ **** ] グループで [プロパティ **** ] をクリックして、ブート イメージの [プロパティ **** ] ダイアログ ボックスを開きます。  

5.  **[データ ソース]** タブで、 **[このブート イメージを PXE 対応の配布ポイントから展開する]**を選びます。  

    > [!NOTE]  
    >  詳細については、「[PXE を使用したネットワーク経由での Windows の展開](../deploy-use/use-pxe-to-deploy-windows-over-the-network.md)」を参照してください。  

6.  プロパティを構成したら、[OK ****] をクリックします。  

##  <a name="a-namebkmkbootimagelanguagea-configure-multiple-languages-for-boot-image-deployment"></a><a name="BKMK_BootImageLanguage"></a> ブート イメージの展開のための複数言語の構成  
 ブート イメージは言語に依存しません。 そのため、WinPE で、Windows PE のオプションのコンポーネントから適切な言語のサポートを含め、表示できる言語を示す適切なタスク シーケンス変数を設定すると、複数の言語でタスク シーケンス テキストを表示するブート イメージを使用できます。 展開するオペレーティング システムの言語は、Configuration Manager のバージョンにかかわらず、WinPE の場合に表示される言語には依存しません。 ユーザーに表示される言語は、次のように決定されます。  

-   ユーザーが既存のオペレーティング システムからタスク シーケンスを実行すると、Configuration Manager はユーザー用に構成された言語を自動的に使用します。 必須の展開期限の結果としてタスク シーケンスが自動的に実行された場合、Configuration Manager はオペレーティング システムの言語を使用します。  

-   PXE またはメディアを使用するオペレーティング システム展開の場合、起動前コマンドの一部として SMSTSLanguageFolder 変数で言語 ID 値を設定できます。 コンピューターを WinPE で起動すると、変数で指定した言語でメッセージが表示されます。 指定したフォルダーの言語リソース ファイルにアクセスできない場合、または変数を設定しなかった場合、メッセージは WinPE の言語で表示されます。  

    > [!NOTE]  
    >  メディアがパスワードで保護されている場合、パスワードの入力をユーザーに求めるテキストは、常に WinPE の言語で表示されます。  

 PXE またはメディアから開始されたオペレーティング システムの展開の場合、次の手順で WinPE の言語を設定します。  

#### <a name="to-set-the-windows-pe-language-for-a-pxe-or-media-initiated-operating-system-deployment"></a>PXE またはメディアから開始されたオペレーティング システムの展開の場合に Windows PE の言語を設定するには  

1.  ブート イメージを更新する前に、適切なタスク シーケンス リソース ファイル (tsres.dll) がサイト サーバーの対応する言語フォルダー内にあることを確認します。 たとえば、英語版のリソース ファイルは <*ConfigMgrInstallationFolder*>\OSD\bin\x64\00000409\tsres.dll にあります。  

2.  起動前コマンドの一部として、SMSTSLanguageFolder 環境変数を適切な言語 ID に設定します。 言語 ID は、16 進数ではなく 10 進数を使用して指定する必要があります。 たとえば、言語 ID を英語に設定するには、フォルダー名に使用される 16 進数の 00000409 ではなく、10 進数の 1033 を指定します。  



<!--HONumber=Nov16_HO1-->


